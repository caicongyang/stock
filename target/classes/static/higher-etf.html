<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>tom.cai选股助手之etf创新高</title>
  <!-- meta使用viewport以确保页面可自由缩放 -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- 引入 jQuery Mobile 样式 -->
  <link rel="stylesheet"
        href="http://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.css">

  <!-- 引入 jQuery 库 -->
  <script src="http://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>

  <!-- 引入 jQuery Mobile 库 -->
  <script src="http://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <style>
    th {
      border-bottom: 1px solid #d6d6d6;
    }

    tr:nth-child(even) {
      background: #e9e9e9;
    }

    .ui-content {
      overflow-x: scroll;
    }
  </style>
  <script>
    /**
     * [通过参数名获取url中的参数值]
     * 示例URL:http://htmlJsTest/getrequest.html?uid=admin&rid=1&fid=2&name=小明
     * @param  {[string]} queryName [参数名]
     * @return {[string]}           [参数值]
     */
    function GetQueryValue(queryName) {
      var query = decodeURI(window.location.search.substring(1));
      var vars = query.split("&");
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (pair[0] == queryName) {
          return pair[1];
        }
      }
      return null;
    }
  </script>
</head>
<body>

<div data-role="header">
  <h1 id="titleData"></h1>
</div>

<div data-role="main" class="ui-content">


  <table data-role="table" data-mode="columntoggle" class="ui-responsive ui-shadow" id="myTable">
    <thead>
    <tr>
      <th>股票</th>
      <th>名称</th>
      <th>intervalDays</th>
      <th>previousHighsDate</th>


    </tr>
    </thead>
    <tbody id="tbodydata">

    </tbody>
  </table>
</div>

<div data-role="footer">
  <h1>股市有风险，入市需谨慎</h1>
</div>


</body>
<script>
  $(document).ready(function () {
    var dayStr = GetQueryValue('day');
    if (dayStr == null || dayStr == undefined || dayStr == '') {
      var day = new Date();
      day.setTime(day.getTime());
      dayStr = day.getFullYear() + "-" + (day.getMonth() + 1) + "-" + day.getDate();
    }
    $.get("/t-etf/getHigherEtf",
        {
          currentDate: dayStr
        },
        function (data, status) {
          if (data.code == 0) {
            optionJson = data.data;
            var html = "";
            if (optionJson.length > 0) {
              for (var i = 0; i < optionJson.length; i++) {
                var  url = "https://m.10jqka.com.cn/stockpage/hs_"
                    + optionJson[i].stockCode.split(".")[0]+"/#&atab=geguNews";
                html += "<tr>";
                html += "<td><a href=" + url + " target='_blank'>" + optionJson[i].stockCode.split(
                    ".")[0]
                    + "</a></td>";
                html += "<td>" + optionJson[i].stockName + "</td>";
                html += "<td>" + optionJson[i].intervalDays + "</td>";
                html += "<td>" + optionJson[i].previousHighsDate + "</td>";

                html += "</tr>";
              }
              $("#titleData").append(optionJson[0].tradingDay + "创新高股票列表");
            }
            $("#tbodydata").html(html);
          }
          else {
            alert(data.msg)
          }
        });
  })
  ;
</script>
</html>